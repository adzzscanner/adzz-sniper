<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Crypto Dip Scanner v7.4.3</title>
  <style>
    body { font-family: monospace; background: #0f0f15; color: #eee; padding: 20px; }
    .signal { margin: 12px 0; padding: 10px; border-radius: 6px; }
    .flash { background: #2a1a3a; border-left: 4px solid #ff6b6b; }
    .normal { background: #1a2a2a; border-left: 4px solid #4ecdc4; }
    .header { color: #ffcc00; margin: 20px 0 10px; }
  </style>
</head>
<body>
  <h2>üöÄ Crypto Dip Scanner v7.4.3</h2>
  <p>Quality‚Äëstrict: Vol ‚â• $5M (rec) | MC ‚â• $10M | Binance USDT only</p>
  <button onclick="runScan()">‚ñ∂Ô∏è Run Scan</button>
  <div id="output" style="margin-top: 20px;"></div>

  <script>
    // ‚úÖ COIN UNIVERSE v7.4.3 (USUSDT REMOVED)
    const FLASH_COINS = [
      "APTUSDT","SKYUSDT","TAOUSDT","JUPUSDT","ACTUSDT",
      "CYBERUSDT","LUNAUSDT","LIGHTUSDT","SQDUSDT","MAGMAUSDT",
      "BEATUSDT","ELIZAOSUSDT","OOOOUSDT"
    ];

    const NORMAL_COINS = [
      "INJUSDT","SOLUSDT","FETUSDT","ZENUSDT","AAVEUSDT",
      "AVAXUSDT","ZROUSDT","ICPUSDT","ZECUSDT","XLMUSDT",
      "LINKUSDT","PYTHUSDT","RENDERUSDT","SUIUSDT","DOTUSDT",
      "ATOMUSDT","NEARUSDT","MATICUSDT","OPUSDT","ARBUSDT",
      "RNDRUSDT","IMXUSDT","SEIUSDT","WLDUSDT","STRKUSDT",
      "ORDIUSDT","BLURUSDT","PEPEUSDT","BONKUSDT","SHIBUSDT",
      "DOGEUSDT","FLOKIUSDT","GALAUSDT","MANAUSDT","SANDUSDT"
    ];

    const ALL_COINS = [...new Set([...FLASH_COINS, ...NORMAL_COINS])];

    // üîß RECOMMENDED: stronger volume filter (e.g. ‚â• $5M)
    const MIN_VOLUME_USD = 5_000_000;

    // üîå Get real-time 24h stats from Binance
    async function fetchTicker(symbol) {
      const res = await fetch(
        `https://api.binance.com/api/v3/ticker/24hr?symbol=${symbol}`
      );
      if (!res.ok) throw new Error(`HTTP ${res.status}`);
      const d = await res.json();
      const price = parseFloat(d.lastPrice);
      const change24h = parseFloat(d.priceChangePercent);  // %
      const volumeBase = parseFloat(d.volume);             // base asset
      const volumeUsd = volumeBase * price;                // approx USDT
      return { price, change24h, volumeUsd };
    }

    function classifySignal(symbol, { price, change24h, volumeUsd }) {
      if (!isFinite(price) || !isFinite(change24h) || !isFinite(volumeUsd)) return null;

      // ‚úÖ Volume rule (recommended)
      if (volumeUsd < MIN_VOLUME_USD) return null;

      const absDip = Math.abs(change24h);
      let mode = null, emoji = "", css = "";

      if (absDip >= 12 && FLASH_COINS.includes(symbol)) {
        mode = "FLASH";
        emoji = "üöÄ";
        css = "flash";
      } else if (absDip >= 8 && absDip < 12 && NORMAL_COINS.includes(symbol)) {
        mode = "NORMAL";
        emoji = "üîç";
        css = "normal";
      } else {
        return null;
      }

      // Entry zone: simple dip-based range around current price
      const entryLow  = (price * (1 - absDip / 100 * 0.6)).toFixed(5);
      const entryHigh = price.toFixed(5);

      // Simplified volScore: 1 per $5M, capped at 150
      const volScore = Math.min(150, Math.floor(volumeUsd / 5_000_000));

      return `
        <div class="signal ${css}">
          ${emoji} ${mode} | ${symbol.replace("USDT","")}
          <br>Price: $${price.toFixed(6)} | Dip: ${absDip.toFixed(2)}% | Vol: $${(volumeUsd/1_000_000).toFixed(1)}M | VolScore: ${volScore}
          <br>Entry: $${entryLow} ‚Äì $${entryHigh} | TP: 10%
        </div>
      `;
    }

    async function runScan() {
      const outEl = document.getElementById("output");
      outEl.innerHTML = `<div class="header">Scanning ${ALL_COINS.length} coins...</div>`;

      const results = [];

      for (const symbol of ALL_COINS) {
        try {
          const data = await fetchTicker(symbol);
          const signal = classifySignal(symbol, data);
          if (signal) results.push(signal);
        } catch (e) {
          // optionally log: console.error(symbol, e);
        }
      }

      if (!results.length) {
        outEl.innerHTML = `<div class="header">‚úÖ 0 Signals</div><div>No valid signals (check dip/volume thresholds).</div>`;
      } else {
        outEl.innerHTML =
          `<div class="header">‚úÖ ${results.length} Signal(s) Found</div>` +
          results.join("");
      }
    }
  </script>
</body>
</html>
