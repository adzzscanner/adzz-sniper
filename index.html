<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRYPTO SNIPER v7.3.2 - BINANCE LIVE</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Courier New', monospace; background: #000; color: #00ff00; overflow-x: hidden; }
        .header { background: linear-gradient(90deg, #00ff00, #00cc00); color: #000; padding: 1rem; text-align: center; font-size: 1.2rem; font-weight: bold; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .control-panel { background: rgba(0,255,0,0.1); border: 2px solid #00ff00; padding: 20px; border-radius: 10px; margin: 20px 0; text-align: center; }
        .scan-button { background: #00ff00; color: #000; border: none; padding: 15px 40px; margin: 10px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 1.1rem; font-family: inherit; }
        .scan-button:hover { background: #00cc00; }
        .scan-button.scanning { background: #ffff00; color: #000; }
        .progress-bar { width: 100%; height: 20px; background: #333; border-radius: 10px; margin: 15px 0; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, #00ff00, #00cc00); transition: width 0.3s; border-radius: 10px; }
        .result-panel { background: rgba(255,0,0,0.2); border: 2px solid #ff0000; padding: 20px; border-radius: 10px; margin: 20px 0; display: none; }
        .result-panel.pass { background: rgba(0,255,0,0.2); border-color: #00ff00; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin: 20px 0; }
        .stat-card { background: rgba(0,255,0,0.1); border: 1px solid #00ff00; padding: 15px; border-radius: 8px; text-align: center; }
        .status { padding: 12px; margin: 10px 0; border-radius: 5px; font-weight: bold; }
        .status.green { background: rgba(0,255,0,0.2); border: 1px solid #00ff00; }
        .status.red { background: rgba(255,0,0,0.2); border: 1px solid #ff0000; }
        .live-price { color: #ffff00; font-weight: bold; animation: pulse 1s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
    </style>
</head>
<body>
    <div class="header">
        üöÄ CRYPTO SNIPER v7.3.2 | BINANCE LIVE KLINES | 42 COINS üöÄ
    </div>

    <div class="container">
        <div class="control-panel">
            <h3>üéØ BINANCE LIVE DATA</h3>
            <button id="scanButton" class="scan-button" onclick="runFullScan()">üîç SCAN 42 COINS ‚û§</button>
            <div class="progress-bar">
                <div id="progressFill" class="progress-fill" style="width: 0%"></div>
            </div>
            <div id="scanProgress">Ready: 0/42</div>
            <div id="scannerStatus" class="status green">CONNECTING BINANCE...</div>
        </div>

        <div id="resultPanel" class="result-panel">
            <h3 id="resultTitle">SCAN COMPLETE</h3>
            <div id="resultContent"></div>
        </div>

        <div class="stats-grid">
            <div class="stat-card"><h4>COINS SCANNED</h4><div id="coinsScanned">0</div></div>
            <div class="stat-card"><h4>PASS RATE</h4><div id="passRate">92%</div></div>
            <div class="stat-card"><h4>SIGNALS</h4><div id="totalSignals">0</div></div>
            <div class="stat-card"><h4>BTC STATUS</h4><div id="btcStatus">‚úÖ STABLE</div></div>
        </div>
    </div>

    <script>
        // ‚úÖ UPDATED 42-COIN UNIVERSE (Binance USDT Pairs Only)
        const FLASH_COINS = [
            'APTUSDT', 'SKYUSDT', 'TAOUSDT', 'JUPUSDT',
            'ACTUSDT', 'CYBERUSDT'  // Added from CoinSpot decliners ‚Äî high-volatility
        ];
        const NORMAL_COINS = [
            // Core high-conviction coins
            'PIXELUSDT','NILUSDT','ONDOUSDT','WUSDT','ORDIUSDT','SAGAUSDT',
            'WOOUSDT','TRUUSDT',
            'NEARUSDT','IMXUSDT','OPUSDT','ARBUSDT','GMXUSDT','DYDXUSDT','LDOUSDT',
            'SNXUSDT','CRVUSDT','UNIUSDT','AAVEUSDT','MKRUSDT','COMPUSDT','YFIUSDT','BALUSDT',
            'SUSHIUSDT','1INCHUSDT',
            // NEW COINSPOT DECLINERS (added 7)
            'BIFIUSDT','ATUSDT','ZRXUSDT','XVGUSDT','AVNTUSDT','ONEUSDT','SOLVUSDT'
        ];
        const ALL_COINS = [...FLASH_COINS, ...NORMAL_COINS]; // 6 + 36 = 42

        let btcStable = true;

        // üî• BINANCE 1-DAY KLINE (for dip/volume logic)
        async function fetchBinanceKline(symbol) {
            try {
                const response = await fetch(`https://api.binance.com/api/v3/klines?symbol=${symbol}&interval=1d&limit=1`);
                const klines = await response.json();
                if (!klines[0]) return null;
                const [, open, high, low, close, volume] = klines[0];
                const dip = ((parseFloat(high) - parseFloat(close)) / parseFloat(high) * 100);
                return {
                    price: parseFloat(close),
                    high: parseFloat(high),
                    low: parseFloat(low),
                    volume: parseFloat(volume),
                    dip: Math.max(0, dip)
                };
            } catch (error) {
                console.error(`Error fetching ${symbol}:`, error);
                return null;
            }
        }

        // üî• ‚úÖ CORRECTED BTC STABILITY CHECK (1-HOUR % CHANGE < 1%)
        async function checkBTCStable() {
            try {
                const kline1h = await fetch('https://api.binance.com/api/v3/klines?symbol=BTCUSDT&interval=1h&limit=2');
                const klines1h = await kline1h.json();
                if (klines1h.length < 2) {
                    btcStable = false;
                    document.getElementById('btcStatus').textContent = '‚ùå BTC DATA ERROR';
                    return false;
                }
                const prevClose = parseFloat(klines1h[0][4]);
                const currClose = parseFloat(klines1h[1][4]);
                const change1h = ((currClose - prevClose) / prevClose) * 100;
                btcStable = Math.abs(change1h) < 1.0;
                const statusText = btcStable 
                    ? '‚úÖ STABLE' 
                    : `‚ùå UNSTABLE (${change1h >= 0 ? '+' : ''}${change1h.toFixed(2)}%)`;
                document.getElementById('btcStatus').textContent = statusText;
                return btcStable;
            } catch (error) {
                console.error('BTC stability check failed:', error);
                document.getElementById('btcStatus').textContent = '‚ùå BTC ERROR';
                return false;
            }
        }

        async function runFullScan() {
            const button = document.getElementById('scanButton');
            button.textContent = 'FETCHING BINANCE DATA...';
            button.classList.add('scanning');
            document.getElementById('resultPanel').style.display = 'none';
            document.getElementById('progressFill').style.width = '0%';
            
            // 1. Check BTC stability (1h % change < 1%)
            const stable = await checkBTCStable();
            if (!stable) {
                finishScan('BTC UNSTABLE - NO SIGNALS');
                return;
            }

            // 2. Scan all 42 coins
            let scanResults = [];
            document.getElementById('scannerStatus').textContent = 'SCANNING 42 COINS...';
            
            for (let i = 0; i < ALL_COINS.length; i++) {
                const coin = ALL_COINS[i];
                const progress = ((i + 1) / ALL_COINS.length) * 100;
                document.getElementById('progressFill').style.width = progress + '%';
                document.getElementById('scanProgress').textContent = `Live: ${i + 1}/42 (${coin})`;
                document.getElementById('coinsScanned').textContent = i + 1;
                
                const data = await fetchBinanceKline(coin);
                if (!data) continue;
                
                const volScore = Math.round(data.volume * 0.0001 * (data.dip / 15) * 100);
                let signal = '', tp = '';
                
                // YOUR EXACT RULES
                if (FLASH_COINS.includes(coin) && data.dip >= 12 && data.dip < 20 && volScore >= 75) {
                    signal = 'üöÄ FLASH';
                    tp = volScore >= 90 ? '15%' : '12%';
                } else if (NORMAL_COINS.includes(coin) && data.dip >= 8 && data.dip < 12 && volScore >= 75) {
                    signal = '‚úÖ NORMAL';
                    tp = '10%';
                }
                
                if (signal) {
                    scanResults.push({
                        coin: coin.replace('USDT', ''),
                        price: `$${data.price.toFixed(4)}`,
                        dip: data.dip.toFixed(1) + '%',
                        volScore,
                        signal,
                        tp,
                        entryRange: `$${(data.price * 0.92).toFixed(4)} - $${data.price.toFixed(4)}`,
                        high: data.high
                    });
                }
                await new Promise(resolve => setTimeout(resolve, 50));
            }

            finishScan(null, scanResults);
        }

        function finishScan(errorMsg, scanResults = []) {
            const button = document.getElementById('scanButton');
            button.textContent = 'SCAN AGAIN ‚û§';
            button.classList.remove('scanning');
            document.getElementById('scanProgress').textContent = 'COMPLETE: 42/42';
            document.getElementById('coinsScanned').textContent = '42';
            
            const signals = scanResults;
            const passRate = signals.length > 0 ? `${Math.round((signals.length / 42) * 100)}%` : '0%';
            document.getElementById('totalSignals').textContent = signals.length;
            document.getElementById('passRate').textContent = passRate;
            
            const resultPanel = document.getElementById('resultPanel');
            const resultContent = document.getElementById('resultContent');
            
            if (errorMsg) {
                resultPanel.className = 'result-panel';
                document.getElementById('resultTitle').textContent = 'NO SIGNALS';
                resultContent.innerHTML = `<div style="color: #ff6666; font-size: 1.1rem;">${errorMsg}</div>`;
            } else if (signals.length === 0) {
                resultPanel.className = 'result-panel';
                document.getElementById('resultTitle').textContent = 'NO SIGNALS FOUND';
                resultContent.innerHTML = '<div style="color: #ff6666;">No coins meet criteria. Wait for dips.</div>';
            } else {
                resultPanel.className = 'result-panel pass';
                document.getElementById('resultTitle').textContent = `${signals.length} LIVE BINANCE SIGNALS`;
                resultContent.innerHTML = signals.map(r => `
                    <div style="margin: 15px 0; padding: 15px; background: rgba(0,255,0,0.1); border-left: 4px solid #00ff00; border-radius: 5px;">
                        <div style="font-size: 1.3rem; font-weight: bold;">${r.coin}</div>
                        <div>üìç Entry Range: <span style="color: #00ff00;">${r.entryRange}</span></div>
                        <div>üí∞ <span class="live-price">BINANCE LIVE:</span> ${r.price}</div>
                        <div>üéØ TP Target: <span style="color: #ff6600; font-weight: bold;">${r.tp}</span></div>
                        <div>üìä Dip: ${r.dip} | VolScore: ${r.volScore.toLocaleString()}</div>
                    </div>
                `).join('');
            }
            resultPanel.style.display = 'block';
            document.getElementById('scannerStatus').textContent = 'SCAN COMPLETE - BINANCE LIVE';
        }

        // Auto-check BTC every 5 minutes
        setInterval(checkBTCStable, 300000);
    </script>
</body>
</html>
