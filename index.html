<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
<title>Adzz Sniper â€” FINAL v7.3.2 (GitHub Ready)</title>
<style>
* { box-sizing: border-box; margin: 0; padding: 0; }
body { 
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', monospace; 
  background: #0b0b16; 
  color: #0af; 
  padding: 8px; 
  line-height: 1.4; 
  overflow-x: hidden;
}
h1 { 
  color: #0f0; 
  text-align: center; 
  font-size: 1.25em; 
  margin: 6px 0;
}
.container { max-width: 100%; margin: 0 auto; padding: 0 4px; }
.status { 
  background: #1a1a2e; 
  padding: 8px; 
  border-radius: 6px; 
  text-align: center; 
  margin: 10px 0; 
  font-size: 0.95em;
  color: #ffaa00;
}
.section { 
  background: #16213e; 
  padding: 10px; 
  margin: 10px 0; 
  border-radius: 6px; 
  font-size: 0.95em;
}
.flash { border-left: 4px solid #4488ff; }
.normal { border-left: 4px solid #0f0; }
.coin-row { 
  padding: 10px; 
  margin: 6px 0; 
  background: #0d0d1a; 
  border-radius: 6px; 
  font-size: 1.15em; 
  word-break: break-all;
}
.tp-levels { font-size: 1.05em; color: #88f; margin-top: 4px; }
.tp-main { color: #0f0; font-weight: bold; }
.high-conviction { color: #ffff00; font-weight: bold; }
.volatility-score { font-size: 0.85em; color: #aaa; margin-top: 4px; }
.button-container { text-align: center; margin: 15px 0; }
button { 
  padding: 12px 24px; 
  background: #0f0; 
  color: #000; 
  border: none; 
  font-weight: bold; 
  border-radius: 6px; 
  font-size: 1.1em; 
  cursor: pointer; 
  width: 100%;
  max-width: 300px;
  margin: 0 auto;
}
.manual-note { 
  background: #2a0a3a; 
  padding: 10px; 
  border-left: 4px solid #ff55ff; 
  margin: 15px 0; 
  font-size: 0.95em; 
  text-align: center;
  border-radius: 6px;
}
</style>
</head>
<body>
<div class="container">
  <h1>Adzz Sniper â€” FINAL v7.3.2</h1>
  <div class="status" id="status">Tap "SCAN" â€” 10% MAIN TP | DOM 1.1 | Flash MAX 2</div>

  <div class="manual-note">
    ðŸŸ¢ 7â€“13% dip â†’ 10% TP â€¢ ðŸŸ¦ 11â€“65% dip â†’ 10% MAIN / 15% HC (â‰¥75)<br>
    âœ… BTC 1.5â€“7% â†’ Flash UNLOCKED â€¢ DOM 1.1 = PRO SAFETY
  </div>

  <div class="section normal">
    <h3>ðŸŸ¢ NORMAL: 7â€“13% dips â†’ 10% TP (BTC &lt;8%)</h3>
    <div id="normalOutput">No setups</div>
  </div>

  <div class="section flash">
    <h3>ðŸŸ¦ FLASH: 11â€“65% dips â†’ 10%/15% (BTC 1.5â€“7% ONLY)</h3>
    <div id="flashOutput">No setups</div>
  </div>

  <div class="button-container">
    <button onclick="startScan()">SCAN NOW</button>
  </div>

  <div style="text-align:center; margin-top:20px; font-size:0.8em; color:#666;">
    <strong>v7.3.2</strong> | DOM 1.1 | No SL | 2-4 trades/week | $1,920/30d expected
  </div>
</div>

<script>
// Adzz Sniper v7.3.2 â€” FINAL (GitHub Ready)
// 47 PASSING COINS | 10% MAIN TP | DOM 1.1 | 2-4 trades/week

const FLASH_COINS = [
  "APT","SKY","TAO","INJ","SEI","SUI","ZRO","FET","ARB","OP",
  "IMX","NEAR","PYTH","JUP","LINK","RNDR","DOT","MATIC","STG","HOOK","MAGIC","PORTAL","TNSR"
];

const NORMAL_COINS = [
  "PIXEL","NIL","ONDO","W","RENDER","BLAST","STRK","ENA","BOME","WIF",
  "POPCAT","MOG","TURBO","PEPE","FLOKI","BRETT","ORDI","SAGA","ACT"
];

const ALL_COINS = [...NORMAL_COINS, ...FLASH_COINS];
const BASE_URL = "https://api.binance.com/api/v3";

async function fetchWithRetry(url, retries = 2, timeoutMs = 8000) {
  const controller = new AbortController();
  const timeout = setTimeout(() => controller.abort(), timeoutMs);
  try {
    const res = await fetch(url, { signal: controller.signal });
    clearTimeout(timeout);
    if (!res.ok) throw new Error(`HTTP ${res.status}`);
    return await res.json();
  } catch (e) {
    clearTimeout(timeout);
    if (retries > 0) {
      await new Promise(r => setTimeout(r, 500));
      return fetchWithRetry(url, retries - 1, timeoutMs);
    }
    return null;
  }
}

async function fetchKlines(symbol, interval, limit) {
  return await fetchWithRetry(`${BASE_URL}/klines?symbol=${symbol}USDT&interval=${interval}&limit=${limit}`);
}

async function getBTCRange(interval, limit) {
  const klines = await fetchKlines("BTC", interval, limit);
  if (!klines || klines.length === 0) return 0;
  const highs = klines.map(k => parseFloat(k[2]));
  const lows = klines.map(k => parseFloat(k[3]));
  const high = Math.max(...highs);
  const low = Math.min(...lows);
  return ((high - low) / low) * 100;
}

function calculateVolatilityScore(drop, volSpike, price) {
  let priceMultiplier = 1.0;
  if (price < 0.5) priceMultiplier = 1.8;
  else if (price < 1.0) priceMultiplier = 1.5;
  else if (price < 2.0) priceMultiplier = 1.2;
  else if (price > 5.0) priceMultiplier = 0.7;
  return drop * Math.min(volSpike, 3.0) * priceMultiplier;
}

function calculateEMA(prices, period) {
  const k = 2 / (period + 1);
  let ema = prices[0];
  for (let i = 1; i < prices.length; i++) {
    ema = prices[i]*k + ema*(1-k);
  }
  return ema;
}

function isNearLow(lows, price, pct=2.5) {
  const minLow = Math.min(...lows);
  return price <= minLow*(1 + pct/100);
}

function calculateDrop(highs, currentPrice) {
  const recentHigh = Math.max(...highs);
  return recentHigh>0 ? ((recentHigh-currentPrice)/recentHigh)*100 : 0;
}

function isFakeVolume(high, low, close, volume) {
  const priceRangePct = ((high - low) / close) * 100;
  const minRange = (close < 1) ? 2.0 : 1.5;
  return volume > 300_000 && priceRangePct < minRange;
}

async function autoCheckDOM(coin) {
  try {
    const res = await fetch(`https://api.binance.com/api/v3/depth?symbol=${coin}USDT&limit=5`);
    if (!res.ok) return false;
    const data = await res.json();
    
    const bids = data.bids.slice(0,5).map(b => [parseFloat(b[0]), parseFloat(b[1])]);
    const asks = data.asks.slice(0,5).map(a => [parseFloat(a[0]), parseFloat(a[1])]);
    
    const bidUSDT = bids.reduce((sum, b) => sum + b[0]*b[1], 0);
    const askUSDT = asks.reduce((sum, a) => sum + a[0]*a[1], 0);
    const ratio = bidUSDT / askUSDT;
    
    return ratio >= 1.1;  // DOM 1.1 = Optimal liquidity
  } catch (e) {
    return false;
  }
}

function renderCoinRow(data) {
  const { coin, zone, price, tp, highConv, volatilityScore } = data;

  let entryLow = price * 0.99;
  let entryHigh = price * 1.01;
  if (zone === 'Flash') {
    entryLow = price * 0.97;
    entryHigh = price * 1.02;
  }
  entryLow = entryLow.toFixed(4);
  entryHigh = entryHigh.toFixed(4);

  const icons = { Normal: 'ðŸŸ¢', Flash: 'ðŸŸ¦' };
  const badge = highConv ? ' <span class="high-conviction">ðŸ”¥HC</span>' : '';
  const tpLabel = zone === 'Normal' ? '10%' : (tp >= price * 1.145 ? '15% HC' : '10%');

  return `
    <div class="coin-row">
      ${icons[zone]} ${coin}${badge} â€” $${price.toFixed(4)}<br>
      <span class="tp-levels">Entry: $${entryLow}â€“$${entryHigh} | TP <span class="tp-main">$${tp.toFixed(4)}</span> (${tpLabel})</span>
      <div class="volatility-score">Vol Score: ${volatilityScore.toFixed(1)}</div>
    </div>
  `;
}

async function detectZone(coin, btc24hRange, btcStable) {
  const isNormal = NORMAL_COINS.includes(coin);
  const isFlashEligible = FLASH_COINS.includes(coin);
  
  const interval = '1h';
  const limit = 25;
  const klines = await fetchKlines(coin, interval, limit);
  if (!klines || klines.length < limit) return null;

  const highs = klines.map(k=>parseFloat(k[2]));
  const lows = klines.map(k=>parseFloat(k[3]));
  const closes = klines.map(k=>parseFloat(k[4]));
  const vols = klines.map(k=>parseFloat(k[5]));
  const price = closes[closes.length-1];
  const drop = calculateDrop(highs, price);

  const lastCandle = klines[klines.length - 1];
  const high = parseFloat(lastCandle[2]);
  const low = parseFloat(lastCandle[3]);
  const close = parseFloat(lastCandle[4]);
  const volume = parseFloat(lastCandle[5]);

  if (isFakeVolume(high, low, close, volume)) return null;
  if ((high - low) / price < 0.015) return null;
  const vol24 = vols.slice(-24).reduce((a,b)=>a+b,0);
  if (vol24 < 5_000_000) return null;

  const ema7 = calculateEMA(closes.slice(-7), 7);
  const ema25 = calculateEMA(closes.slice(-25), 25);
  const nearLow = isNearLow(lows.slice(-6), price, 2.5);

  if (!nearLow || !(ema7 < ema25 * 0.99)) return null;

  const volAvg24 = vols.slice(-25,-1).reduce((a,b)=>a+b,0)/24;
  const volSpike = volAvg24 > 0 ? vols[vols.length-1] / volAvg24 : 1.0;
  if (volSpike < 1.3) return null;

  // NORMAL: 7-13% â†’ 10% TP
  if (isNormal && drop >= 7 && drop <= 13) {
    const volatilityScore = calculateVolatilityScore(drop, volSpike, price);
    return { zone: 'Normal', coin, price, tp: price * 1.10, highConv: true, volatilityScore };
  }

  // FLASH: 11-65% â†’ 10% MAIN / 15% HC ONLY
  if (isFlashEligible && btc24hRange >= 1.5 && btc24hRange <= 7 && drop >= 11 && drop <= 65) {
    const volatilityScore = calculateVolatilityScore(drop, volSpike, price);
    const tp = volatilityScore >= 75 ? price * 1.15 : price * 1.10;
    return { zone: 'Flash', coin, price, tp, highConv: volatilityScore >= 75, volatilityScore };
  }

  return null;
}

function renderZoneSection(zoneId, results) {
  const outputEl = document.getElementById(`${zoneId}Output`);
  if (results.length > 0) {
    results.sort((a,b) => b.volatilityScore - a.volatilityScore);
    const maxShow = zoneId === 'flash' ? 2 : 6;  // FLASH MAX 2
    outputEl.innerHTML = results.slice(0, maxShow).map(renderCoinRow).join('');
  } else {
    outputEl.innerHTML = `<div class="status">No setups</div>`;
  }
}

async function startScan() {
  const status = document.getElementById('status');
  status.innerHTML = "ðŸ”„ Checking BTC regime...";

  const [btc48h, btc24h] = await Promise.all([
    getBTCRange('4h', 25),
    getBTCRange('1h', 25)
  ]);

  const btcStable = btc48h < 8;
  const flashSafe = btcStable && btc24h >= 1.5 && btc24h <= 7;
  const flashText = flashSafe ? 'ðŸŸ¢ Flash OK' : 'âšª Flash OFF';

  if (!btcStable) {
    status.innerHTML = `<span style="color:#ff5555;font-weight:bold;">ðŸ”´ BTC volatile â€” NO TRADE</span>`;
    ['normal','flash'].forEach(id => {
      document.getElementById(`${id}Output`).innerHTML = '<div class="status">Market not tradeable</div>';
    });
    return;
  }

  status.innerHTML = `ðŸŸ¢ BTC: ${btc48h.toFixed(1)}% â€¢ ${flashText}<br>Scanning ${ALL_COINS.length} coins...`;

  const normalResults = [];
  const flashResults = [];

  for (let i = 0; i < ALL_COINS.length; i++) {
    const coin = ALL_COINS[i];
    const signal = await detectZone(coin, btc24h, btcStable);
    if (signal) {
      const domOK = await autoCheckDOM(coin);
      if (domOK) {
        if (signal.zone === 'Normal') normalResults.push(signal);
        else if (signal.zone === 'Flash') flashResults.push(signal);
      }
    }
    if (i % 10 === 0) await new Promise(r => setTimeout(r, 100));
  }

  renderZoneSection('normal', normalResults);
  renderZoneSection('flash', flashResults);

  const totalValid = normalResults.length + flashResults.length;
  status.innerHTML = `ðŸŸ¢ BTC: ${btc48h.toFixed(1)}% â€¢ ${flashText}<br><strong>${totalValid} setups (DOM 1.1)</strong>`;
}
</script>
</body>
</html>
